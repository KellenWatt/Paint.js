define("definitions",["require","exports"],function(t,e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var i=function(){function t(t,e){this.x=t,this.y=e}return t}()
e.Point=i}),define("PaintHistory",["require","exports"],function(t,e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var i=function(){function t(t,e,i,n,s,o,a,r,h,c){this.tool=t,this.color=e,this.fill=i,this.weight=n,this.x=s,this.y=o,this.dx=a,this.dy=r,this.imageData=h,this.points=c}return t}()
e.HistoryNode=i
var n=function(){function t(){this.versions=[],this.selectedVersion=0}return t.prototype.addAction=function(t){this.versions.push(t),this.versions.length>2&&this.versions.shift(),this.selectedVersion=this.versions.length-1},t.prototype.currentVersion=function(t){return this.versions[t]},t.prototype.branchCount=function(){return this.versions.length},t}()
e.HistoryLayer=n
var s=function(){function t(t){this.states=[],this.currentLayer=0,this.version=0,this.inPrevState=!1,this.states.push(new n),this.states[0].addAction(new i(null,null,null,null,null,null,null,null,t,[]))}return t.prototype.pushAction=function(t,e,s,o,a,r,h,c,p,u){this.inPrevState||this.states.push(new n),this.currentLayer+=1,this.currentLayer==this.states.length-1&&(this.inPrevState=!1),this.states[this.currentLayer].addAction(new i(t,e,s,o,a,h,r,c,p,u))},t.prototype.undo=function(t,e){0!=this.currentLayer&&(this.inPrevState=!0,this.currentLayer=t,this.version=e)},t.prototype.quickUndo=function(){0!=this.currentLayer&&(this.inPrevState=!0,this.currentLayer-=1,this.version=this.states[this.currentLayer].selectedVersion)},t.prototype.redo=function(t,e){this.currentLayer!=this.states.length-1&&(this.currentLayer=t,this.version=e,t==this.states.length-1&&(this.inPrevState=!1))},t.prototype.quickRedo=function(){this.currentLayer!=this.states.length-1&&(this.currentLayer+=1,this.version=this.states[this.currentLayer].selectedVersion,this.currentLayer==this.states.length-1&&(this.inPrevState=!1))},t.prototype.fullHistory=function(){return this.states},t.prototype.getCurrentState=function(){return this.states[this.currentLayer]},t.prototype.getImageData=function(t){return this.states[this.currentLayer].currentVersion(t).imageData},t.loadObject=function(e){var n=e.states[0].versions[0].imageData,s=new t(n)
e.states.shift()
for(var o=0,a=e.states;o<a.length;o++){var r=a[o],h=r.versions[0]
if(s.pushAction(h.tool,h.color,h.fill,h.weight,h.x,h.y,h.dx,h.dy,h.imageData,h.points),r.versions.length>1){var c=r.versions[1]
s.states[s.currentLayer].addAction(new i(c.tool,c.color,c.fill,c.weight,c.x,c.y,c.dx,c.dy,c.imageData,c.points))}}return s},t}()
e.default=s}),define("PaintLayer",["require","exports","PaintHistory"],function(t,e,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var n=function(){function t(t,e){this._id=e,this._name="Layer "+this._id,this._canvas=document.createElement("canvas"),this._canvas.width=t.offsetWidth,this._canvas.height=t.offsetHeight,this._canvas.style.position="absolute",this._canvas.style.left="0px",this._canvas.style.top="0px",t.insertBefore(this._canvas,t.firstChild),this._context=this._canvas.getContext("2d"),this._history=new i.default(this._canvas.toDataURL())}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"history",{get:function(){return this._history},enumerable:!0,configurable:!0}),t.prototype.finalize=function(){this._id=-1,this._name=null,this._canvas.parentNode.removeChild(this._canvas),this._canvas=null,this._context=null},t.loadObject=function(e,n){var s=new t(n,e._id)
return s._history=i.default.loadObject(e._history),s},t}()
e.Layer=n,e.default=n}),define("tools/pencil",["require","exports","definitions"],function(t,e,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var n=function(){function t(){this.name="pencil",this.drawOnMove=this.draw.bind(this)}return t.prototype.prep=function(t){this.paint=t,this.paint.fill&&(this.paint.context.save(),this.paint.context.lineWidth=1),this.paint.canvas.addEventListener("mousemove",this.drawOnMove)},t.prototype.draw=function(){this.paint.mouseMoved=!0,this.paint.context.lineTo(this.paint.mouse.x,this.paint.mouse.y),this.paint.context.stroke(),this.paint.points.push(new i.Point(this.paint.mouse.x,this.paint.mouse.y))},t.prototype.finish=function(){if(this.paint.canvas.removeEventListener("mousemove",this.drawOnMove),this.paint.fill){var t=this.paint.currentLayer.context
t.beginPath(),t.moveTo(this.paint.points[0].x,this.paint.points[0].y)
for(var e=0,i=this.paint.points;e<i.length;e++){var n=i[e]
t.lineTo(n.x,n.y)}t.fill(),this.paint.context.restore()}else this.paint.currentLayer.context.drawImage(this.paint.canvas,0,0)
if(this.paint.mouseMoved){var s=this.paint.fill?this.paint.primaryColor:this.paint.secondaryColor,o=this.paint.mouse.x-this.paint.mouseLock.x,a=this.paint.mouse.y-this.paint.mouseLock.y
this.paint.currentLayer.history.pushAction(this.name,s,this.paint.fill,this.paint.weight,this.paint.mouseLock.x,this.paint.mouseLock.y,o,a,this.paint.currentLayer.canvas.toDataURL(),this.paint.points)}this.paint.points=[]},t}()
e.default=n}),define("tools/brush",["require","exports","definitions"],function(t,e,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var n=function(){function t(){this.name="brush",this.drawOnMove=this.draw.bind(this)}return t.prototype.prep=function(t){this.paint=t,this.paint.context.save(),this.paint.canvas.addEventListener("mousemove",this.drawOnMove)},t.prototype.draw=function(){this.paint.mouseMoved=!0
for(var t=Math.sqrt(Math.pow(this.paint.mouseLock.x-this.paint.mouse.x,2)+Math.pow(this.paint.mouseLock.y-this.paint.mouse.y,2)),e=Math.atan2(this.paint.mouse.x-this.paint.mouseLock.x,this.paint.mouse.y-this.paint.mouseLock.y),n=0;n<t;n+=this.paint.weight/8){var s=this.paint.mouseLock.x+Math.sin(e)*n,o=this.paint.mouseLock.y+Math.cos(e)*n,a=this.paint.context.createRadialGradient(s,o,this.paint.weight/4,s,o,this.paint.weight/2)
a.addColorStop(0,this.paint.addAlpha(this.paint.primaryColor,1)),a.addColorStop(.5,this.paint.addAlpha(this.paint.primaryColor,.5)),a.addColorStop(1,this.paint.addAlpha(this.paint.primaryColor,0)),this.paint.context.fillStyle=a,this.paint.context.fillRect(s-this.paint.weight/2,o-this.paint.weight/2,this.paint.weight,this.paint.weight),this.paint.points.push(new i.Point(s,o))}this.paint.mouseLock.x=this.paint.mouse.x,this.paint.mouseLock.y=this.paint.mouse.y},t.prototype.finish=function(){this.paint.canvas.removeEventListener("mousemove",this.drawOnMove),this.paint.context.restore(),this.paint.currentLayer.context.drawImage(this.paint.canvas,0,0),this.paint.mouseMoved&&this.paint.currentLayer.history.pushAction("brush",this.paint.primaryColor,!1,this.paint.weight,this.paint.mouseLock.x,this.paint.mouseLock.y,this.paint.mouse.x-this.paint.mouseLock.x,this.paint.mouse.y-this.paint.mouseLock.y,this.paint.currentLayer.canvas.toDataURL(),this.paint.points),this.paint.points=[]},t}()
e.default=n}),define("tools/circle",["require","exports"],function(t,e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var i=function(){function t(){this.name="circle",this.drawOnMove=this.draw.bind(this)}return t.prototype.prep=function(t){this.paint=t,this.paint.canvas.addEventListener("mousemove",this.drawOnMove)},t.prototype.draw=function(){this.paint.mouseMoved=!0
var t=Math.sqrt(Math.pow(this.paint.mouse.x-this.paint.mouseLock.x,2)+Math.pow(this.paint.mouse.y-this.paint.mouseLock.y,2))
this.paint.context.clearRect(0,0,this.paint.canvas.width,this.paint.canvas.height),this.paint.context.beginPath(),this.paint.context.arc(this.paint.mouseLock.x,this.paint.mouseLock.y,t,0,2*Math.PI),this.paint.fill?this.paint.context.fill():this.paint.context.stroke()},t.prototype.finish=function(){if(this.paint.canvas.removeEventListener("mousemove",this.drawOnMove),this.paint.currentLayer.context.drawImage(this.paint.canvas,0,0),this.paint.mouseMoved){var t=this.paint.fill?this.paint.primaryColor:this.paint.secondaryColor
this.paint.currentLayer.history.pushAction("circle",t,this.paint.fill,this.paint.weight,this.paint.mouseLock.x,this.paint.mouseLock.y,this.paint.mouse.x-this.paint.mouseLock.x,this.paint.mouse.y-this.paint.mouseLock.y,this.paint.currentLayer.canvas.toDataURL(),[])}},t}()
e.default=i}),define("tools/square",["require","exports"],function(t,e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var i=function(){function t(){this.name="square",this.drawOnMove=this.draw.bind(this)}return t.prototype.prep=function(t){this.paint=t,this.paint.context.save(),this.paint.context.lineJoin="miter",this.paint.canvas.addEventListener("mousemove",this.drawOnMove)},t.prototype.draw=function(){this.paint.mouseMoved=!0,this.paint.context.clearRect(0,0,this.paint.canvas.width,this.paint.canvas.height),this.paint.context.beginPath(),this.paint.context.rect(this.paint.mouseLock.x,this.paint.mouseLock.y,this.paint.mouse.x-this.paint.mouseLock.x,this.paint.mouse.y-this.paint.mouseLock.y),this.paint.fill?this.paint.context.fill():this.paint.context.stroke()},t.prototype.finish=function(){if(this.paint.canvas.removeEventListener("mousemove",this.drawOnMove),this.paint.context.restore(),this.paint.currentLayer.context.drawImage(this.paint.canvas,0,0),this.paint.mouseMoved){var t=this.paint.fill?this.paint.primaryColor:this.paint.secondaryColor
this.paint.currentLayer.history.pushAction("square",t,this.paint.fill,this.paint.weight,this.paint.mouseLock.x,this.paint.mouseLock.y,this.paint.mouse.x-this.paint.mouseLock.x,this.paint.mouse.y-this.paint.mouseLock.y,this.paint.currentLayer.canvas.toDataURL(),[])}},t}()
e.default=i}),define("tools/line",["require","exports"],function(t,e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var i=function(){function t(){this.name="line",this.drawOnMove=this.draw.bind(this)}return t.prototype.prep=function(t){this.paint=t,this.paint.canvas.addEventListener("mousemove",this.drawOnMove)},t.prototype.draw=function(){this.paint.mouseMoved=!0,this.paint.context.clearRect(0,0,this.paint.canvas.width,this.paint.canvas.height),this.paint.context.beginPath(),this.paint.context.moveTo(this.paint.mouseLock.x,this.paint.mouseLock.y),this.paint.context.lineTo(this.paint.mouse.x,this.paint.mouse.y),this.paint.context.stroke()},t.prototype.finish=function(){console.log("finishing"),this.paint.canvas.removeEventListener("mousemove",this.drawOnMove),this.paint.currentLayer.context.drawImage(this.paint.canvas,0,0),this.paint.mouseMoved&&this.paint.currentLayer.history.pushAction("line",this.paint.secondaryColor,!1,this.paint.weight,this.paint.mouseLock.x,this.paint.mouseLock.y,this.paint.mouse.x-this.paint.mouseLock.x,this.paint.mouse.y-this.paint.mouseLock.y,this.paint.currentLayer.canvas.toDataURL(),[])},t}()
e.default=i}),define("tools/text",["require","exports"],function(t,e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var i=function(){function t(){this.name="text",this.drawOnMove=this.draw.bind(this),this.textbox=document.createElement("textarea"),this.textbox.style.position="absolute"}return t.prototype.prep=function(t){this.paint=t,this.paint.context.save(),this.paint.context.lineWidth=1,this.paint.context.strokeStyle="#222",this.paint.canvas.addEventListener("mousemove",this.drawOnMove)},t.prototype.draw=function(){this.paint.mouseMoved=!0,this.paint.context.clearRect(0,0,this.paint.canvas.width,this.paint.canvas.height),this.paint.context.beginPath(),this.paint.context.rect(this.paint.mouseLock.x,this.paint.mouseLock.y,this.paint.mouse.x-this.paint.mouseLock.x,this.paint.mouse.y-this.paint.mouseLock.y),this.paint.context.stroke()},t.prototype.finish=function(){var t=this
this.paint.canvas.removeEventListener("mousemove",this.drawOnMove),this.textbox.style.left=this.paint.mouseLock.x+"px",this.textbox.style.top=this.paint.mouseLock.y+"px",this.textbox.style.width=this.paint.mouse.x-this.paint.mouseLock.x+"px",this.textbox.style.height=this.paint.mouse.y-this.paint.mouseLock.y+"px",this.paint.workspace.appendChild(this.textbox),this.textbox.focus(),this.textbox.addEventListener("blur",function(){t.paint.currentLayer.context.fillText(t.textbox.value,t.paint.mouseLock.x,t.paint.mouseLock.y,t.paint.mouse.x-t.paint.mouseLock.x),t.textbox.value="",t.textbox.remove(),t.paint.mouseMoved&&t.paint.currentLayer.history.pushAction("text",t.paint.primaryColor,!1,t.paint.weight,t.paint.mouseLock.x,t.paint.mouseLock.y,t.paint.mouse.x-t.paint.mouseLock.x,t.paint.mouse.y-t.paint.mouseLock.y,t.paint.currentLayer.canvas.toDataURL(),[])}),this.paint.context.clearRect(0,0,this.paint.canvas.width,this.paint.canvas.height),this.paint.context.restore()},t}()
e.default=i}),define("tools/eraser",["require","exports","definitions"],function(t,e,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var n=function(){function t(){this.name="eraser",this.drawOnMove=this.draw.bind(this)}return t.prototype.prep=function(t){this.paint=t,this.paint.currentLayer.context.save(),this.paint.currentLayer.context.lineJoin="round",this.paint.currentLayer.context.lineCap="round",this.paint.currentLayer.context.globalCompositeOperation="destination-out",this.paint.currentLayer.context.beginPath(),this.paint.canvas.addEventListener("mousemove",this.drawOnMove)},t.prototype.draw=function(){this.paint.mouseMoved=!0,this.paint.currentLayer.context.lineTo(this.paint.mouse.x,this.paint.mouse.y),this.paint.currentLayer.context.stroke(),this.paint.points.push(new i.Point(this.paint.mouse.x,this.paint.mouse.y))},t.prototype.finish=function(){this.paint.canvas.removeEventListener("mousemove",this.drawOnMove),this.paint.currentLayer.context.restore(),this.paint.mouseMoved&&this.paint.currentLayer.history.pushAction("eraser",this.paint.primaryColor,this.paint.fill,this.paint.weight,this.paint.mouseLock.x,this.paint.mouseLock.y,this.paint.mouse.x-this.paint.mouseLock.x,this.paint.mouse.y-this.paint.mouseLock.y,this.paint.currentLayer.canvas.toDataURL(),this.paint.points),this.paint.points=[]},t}()
e.default=n}),define("tools/dropper",["require","exports"],function(t,e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var i=function(){function t(){this.name="dropper",this.drawOnMove=this.draw.bind(this)}return t.prototype.prep=function(t){this.paint=t},t.prototype.draw=function(){},t.prototype.finish=function(){var t=this.paint.currentLayer.context.getImageData(this.paint.mouse.x,this.paint.mouse.y,1,1).data,e=t[0].toString(16),i=t[1].toString(16),n=t[2].toString(16)
1==e.length&&(e="0"+e),1==i.length&&(i="0"+i),1==n.length&&(n="0"+n)
var s="#"+e+i+n
this.paint.setColors(s,s)},t}()
e.default=i}),define("tools/color-picker",["require","exports"],function(t,e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var i=function(){function t(){var t=this
this.name="color",this.drawOnMove=this.draw.bind(this),this.colorChooser=document.createElement("input"),this.colorChooser.type="color",this.colorChooser.addEventListener("change",function(e){var i=e.target.value
t.paint.setColors(i,i)})}return t.prototype.prep=function(t){this.paint=t},t.prototype.draw=function(){},t.prototype.finish=function(){this.colorChooser.click()},t}()
e.default=i}),define("tools/image",["require","exports"],function(t,e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var i=function(){function t(){this.name="image",this.drawOnMove=this.draw.bind(this)}return t.prototype.prep=function(t){this.paint=t,this.paint.canvas.addEventListener("mousemove",this.drawOnMove)},t.prototype.draw=function(){this.paint.mouseMoved=!0,this.paint.context.clearRect(0,0,this.paint.canvas.width,this.paint.canvas.height),this.paint.context.drawImage(this.paint.imageToolImage,this.paint.mouseLock.x,this.paint.mouseLock.y,this.paint.mouse.x-this.paint.mouseLock.x,this.paint.mouse.y-this.paint.mouseLock.y)},t.prototype.finish=function(){this.paint.canvas.removeEventListener("mousemove",this.drawOnMove),this.paint.currentLayer.context.drawImage(this.paint.canvas,0,0),this.paint.mouseMoved&&this.paint.currentLayer.history.pushAction("image","#000000",!1,this.paint.weight,this.paint.mouseLock.x,this.paint.mouseLock.y,this.paint.mouse.x-this.paint.mouseLock.x,this.paint.mouse.y-this.paint.mouseLock.y,this.paint.currentLayer.canvas.toDataURL(),[])},t}()
e.default=i}),define("Paint",["require","exports","definitions","PaintLayer","tools/pencil","tools/brush","tools/circle","tools/square","tools/line","tools/text","tools/eraser","tools/dropper","tools/color-picker","tools/image"],function(t,e,i,n,s,o,a,r,h,c,p,u,l,y){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
var d=function(){function t(t){this.layers=[],this.layerCounter=0,this.colors=["#000000","#000000"],this._weight=10,this.currentTool="pencil",this._fill=!1,this.workspace=t,this.workspace.style.overflow="none",this.mouse=new i.Point(0,0),this.mouseLock=new i.Point(0,0),this.points=[],this.tools={},this.tools.Empty=null
var e=new s.default
this.tools[e.name]=e
var n=new o.default
this.tools[n.name]=n
var d=new a.default
this.tools[d.name]=d
var f=new r.default
this.tools[f.name]=f
var v=new h.default
this.tools[v.name]=v
var m=new c.default
this.tools[m.name]=m
var x=new p.default
this.tools[x.name]=x
var L=new u.default
this.tools[L.name]=L
var g=new l.default
this.tools[g.name]=g
var w=new y.default
this.tools[w.name]=w,this.init()}return Object.defineProperty(t.prototype,"weight",{get:function(){return this._weight},set:function(t){this._weight=t,this.context.lineWidth=t,this.currentLayer.context.lineWidth=t},enumerable:!0,configurable:!0}),t.prototype.addAlpha=function(t,e){return"rgba("+parseInt(t.substring(1,3),16)+","+parseInt(t.substring(3,5),16)+","+parseInt(t.substring(5,7),16)+","+e+")"},t.prototype.setColors=function(t,e){this.colors=[t,e],void 0!==this.colorChangeCallback&&this.colorChangeCallback(!0,!0),this.context.fillStyle=t,this.currentLayer.context.fillStyle=t,this.context.strokeStyle=e,this.currentLayer.context.strokeStyle=e},Object.defineProperty(t.prototype,"primaryColor",{get:function(){return this.colors[0]},set:function(t){this.colors[0]=t,void 0!==this.colorChangeCallback&&this.colorChangeCallback(!0,!1),this.context.fillStyle=t,this.currentLayer.context.fillStyle=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"secondaryColor",{get:function(){return this.colors[1]},set:function(t){this.colors[1]=t,void 0!==this.colorChangeCallback&&this.colorChangeCallback(!1,!0),this.context.strokeStyle=t,this.currentLayer.context.strokeStyle=t},enumerable:!0,configurable:!0}),t.prototype.setColorChangeCallback=function(t){this.colorChangeCallback=t},t.prototype.addLayer=function(){return this.layers.push(new n.default(this.workspace,++this.layerCounter)),this.layers},t.prototype.deleteLayer=function(t){for(var e in this.layers)if(this.layers[e].id===t){this.layers[e].finalize(),this.layers.splice(+e,1)
break}return this.layers},t.prototype.switchLayer=function(t){for(var e=0,i=this.layers;e<i.length;e++){var n=i[e]
if(n.id===t){this.currentLayer=n
break}}this.currentLayer.context.fillStyle=this.context.fillStyle,this.currentLayer.context.strokeStyle=this.context.strokeStyle,this.currentLayer.context.lineWidth=this._weight},Object.defineProperty(t.prototype,"layerList",{get:function(){return this.layers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tool",{get:function(){return this.currentTool},set:function(t){this.currentTool=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageToolImage",{get:function(){return this.image},set:function(t){this.image=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){this._fill=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workingLayer",{get:function(){return this.currentLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"changed",{get:function(){return this.mouseMoved},enumerable:!0,configurable:!0}),t.prototype.undo=function(t,e){var i=this
e=void 0===e?0:e,void 0===t?this.currentLayer.history.quickUndo():this.currentLayer.history.undo(t,e)
var n=new Image
n.addEventListener("load",function(){i.currentLayer.context.clearRect(0,0,i.canvas.width,i.canvas.height),i.currentLayer.context.drawImage(n,0,0)}),n.src=this.currentLayer.history.getImageData(e)},t.prototype.redo=function(t,e){var i=this
e=void 0===e?0:e,void 0===t?this.currentLayer.history.quickRedo():this.currentLayer.history.redo(t,e)
var n=new Image
n.addEventListener("load",function(){i.currentLayer.context.clearRect(0,0,i.canvas.width,i.canvas.height),i.currentLayer.context.drawImage(n,0,0)}),n.src=this.currentLayer.history.getImageData(e)},t.prototype.reconstruct=function(t){for(var e=JSON.parse(t),i=0,s=this.layers;i<s.length;i++){var o=s[i]
o.finalize()}this.layers=[]
for(var a=0,r=e;a<r.length;a++){var o=r[a]
this.layers.push(n.default.loadObject(o,this.workspace))}this.currentLayer=this.layers[this.layers.length-1],this.render()},t.prototype.serialize=function(){return JSON.stringify(this.layers)},t.prototype.render=function(){for(var t=this,e=new Image,i=0,n=this.layers;i<n.length;i++){var s=n[i]
!function(i){e.addEventListener("load",function(){i.context.clearRect(0,0,t.canvas.width,t.canvas.height),i.context.drawImage(e,0,0)}),e.src=i.history.getImageData(i.history.version)}(s)}},t.prototype.collapse=function(){var t=document.createElement("canvas")
t.width=this.canvas.width,t.height=this.canvas.height
for(var e=t.getContext("2d"),i=this.layers.length-1;i>=0;i--)e.drawImage(this.layers[i].canvas,0,0)
return t.toDataURL()},t.prototype.nuke=function(){for(var t=0,e=this.layers;t<e.length;t++){e[t].finalize()}return this.layers=[],this.layerCounter=0,this.currentLayer=this.addLayer()[0],this.layers},t.prototype.clearCurrentLayer=function(){this.currentLayer.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.init=function(){var t=this
this.canvas=document.createElement("canvas"),this.canvas.width=this.workspace.offsetWidth,this.canvas.height=this.workspace.offsetHeight,this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0",this.workspace.appendChild(this.canvas),this.currentLayer=this.addLayer()[0],this.context=this.canvas.getContext("2d"),this.context.lineCap="round",this.context.lineJoin="round",this.canvas.addEventListener("mousemove",function(e){t.mouse.x=e.offsetX,t.mouse.y=e.offsetY})
var e=document.createElement("input")
e.type="color",e.addEventListener("change",function(e){var i=e.target.value
t.setColors(i,i)}),document.createElement("textarea").style.position="absolute",this.canvas.addEventListener("mousedown",function(){t.readOnly||(t.context.beginPath(),t.context.moveTo(t.mouse.x,t.mouse.y),t.mouseLock.x=t.mouse.x,t.mouseLock.y=t.mouse.y,t.mouseMoved=!1,t.tools[t.currentTool].prep(t))}),this.canvas.addEventListener("mouseup",function(){t.readOnly||(t.tools[t.currentTool].finish(),t.context.clearRect(0,0,t.canvas.width,t.canvas.height))})},t}()
e.Paint=d,e.default=d}),require.config({baseUrl:"assets/scripts/",paths:{knockout:"./lib/knockout-3.4.2",jquery:"./lib/jquery-3.2.2.min",Paint:"Paint"}})
